(this.webpackJsonpsmisplan2=this.webpackJsonpsmisplan2||[]).push([[6],{354:function(t,e,a){"use strict";a.d(e,"a",(function(){return j}));var n=a(38),i=a(56),s=a(76),l=a(77),o=a(78),c=a(0),r=a.n(c),u=a(21),d=a.n(u),p=a(374),b=a(364),f=a(2),j=function(t){Object(l.a)(a,t);var e=Object(o.a)(a);function a(t){var n;Object(i.a)(this,a),(n=e.call(this,t)).handleChange=function(t){t&&""!==t&&"null"!==t&&Array.isArray(t)?(n.setState({valueErr:!1}),n.setState({value:t}),"function"===typeof n.props.setValue&&n.props.setValue(t.map((function(t){return t.value})).join(","))):t&&""!==t&&"null"!==t?(n.setState({valueErr:!1}),n.setState({value:t}),"function"===typeof n.props.setValue&&n.props.setValue(t.value)):(n.setState({value:t}),"function"===typeof n.props.setValue&&n.props.setValue(""))},n.setFocus=function(){n.selectRef.focus()},n.filterValues=function(t,e){var a=n.optionsCounter<n.maxOptions;e&&""!==e&&(new RegExp(e,"i").test(t.label)||(a=!1));return a&&n.optionsCounter++,n.optionsCounter!==n.props.options.length&&n.optionsCounter!==n.maxOptions||(n.optionsCounter=0),a};var s="";return n.props.defaultValue?s=n.props.defaultValue:n.props.defaultValue&&(s=[]),n.state={value:s,valueErr:!1,offsetTop:0},n.maxOptions=n.props.maxOptions?n.props.maxOptions:60,n.optionsCounter=0,n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.setState({offsetTop:d.a.findDOMNode(this).offsetTop})}},{key:"render",value:function(){var t=this,e={input:function(t){return Object(n.a)(Object(n.a)({},t),{},{height:"25px",fontFamily:"var(--font-main)",marginTop:"-0.75px",fontSize:"15px",backgroundColor:"transparent"})},control:function(e,a){return Object(n.a)(Object(n.a)({},e),{},{minHeight:"25px",height:"fit-content",fontFamily:"var(--font-main)",fontSize:"15px",backgroundColor:"transparent",border:"0px",borderRadius:"0px",borderBottom:t.state.valueErr||a.selectProps.menuIsOpen?"2px solid":"1px solid",borderColor:t.state.valueErr?"#f44336 !important":a.selectProps.menuIsOpen?"#3f51b5 !important":"rgba(0, 0, 0, 0.42) !important",boxShadow:"none","&:hover":{borderBottom:(a.selectProps.menuIsOpen,"2px solid"),borderColor:t.state.valueErr?"#f44336":a.selectProps.menuIsOpen?"#3f51b5":"black"}})},placeholder:function(e,a){return Object(n.a)(Object(n.a)({},e),{},{height:"25px",fontFamily:"var(--font-main)",fontSize:"15px",color:t.state.valueErr?"#f44336":a.selectProps.menuIsOpen?"#3f51b5":"",backgroundColor:"transparent"})},option:function(t){return Object(n.a)(Object(n.a)({},t),{},{fontFamily:"var(--font-main)",fontSize:"15px",marginTop:"-3px",color:"rgba(0, 0, 0, 0.87)"})},valueContainer:function(t){return Object(n.a)(Object(n.a)({},t),{},{minHeight:"24px",height:"fit-content",marginTop:"-5px",paddingLeft:"0px",marginLeft:"-2px"})},indicatorsContainer:function(t){return Object(n.a)(Object(n.a)({},t),{},{minHeight:"25px !important",padding:"0px !important"})},clearIndicator:function(t){return Object(n.a)(Object(n.a)({},t),{},{padding:"0px 5px 0px 5px !important"})},dropdownIndicator:function(t){return Object(n.a)(Object(n.a)({},t),{},{padding:"0px 5px 0px 5px !important"})}};return Object(f.jsxs)("div",{style:this.props.style,children:[!this.props.isCreatable&&Object(f.jsx)(p.a,{allowCreate:this.props.allowCreate,ref:this.selectRef,options:this.props.options,styles:e,menuPlacement:this.props.bottom||this.state.offsetTop<250?"bottom":"top",value:this.state.value,placeholder:this.props.label,defaultValue:this.props.defaultValue,defaultInputValue:this.props.defaultInputValue,onChange:this.handleChange,onMenuOpen:function(){t.optionsCounter=0},noOptionsMessage:function(){return"\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"},isClearable:!0,isSearchable:!0,required:!0,isMulti:!!this.props.isMulti,style:{width:"200px"},filterOption:this.filterValues}),this.props.isCreatable&&Object(f.jsx)(b.a,{allowCreate:this.props.allowCreate,ref:this.selectRef,options:this.props.options,styles:e,menuPlacement:this.props.bottom||this.state.offsetTop<250?"bottom":"top",value:this.state.value,placeholder:this.props.label,defaultValue:this.props.defaultValue,defaultInputValue:this.props.defaultInputValue,onChange:this.handleChange,onMenuOpen:function(){t.optionsCounter=0},noOptionsMessage:function(){return"\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"},isClearable:!0,isSearchable:!0,required:!0,isMulti:!!this.props.isMulti,style:{width:"200px"},filterOption:this.filterValues})]})}}]),a}(r.a.Component)},356:function(t,e,a){"use strict";a.d(e,"a",(function(){return h}));var n=a(38),i=a(11),s=a(0),l=a.n(s),o=a(35),c=a(432),r=a(135),u=(a(202),a(2));function d(t){var e=l.a.useState(),a=Object(i.a)(e,2),n=a[0],s=a[1];return Object(u.jsx)(o.a,{utils:r.a,children:Object(u.jsx)(c.a,{format:"YYYY-MM-DD HH:mm",fullWidth:!0,ampm:!1,minutesStep:5,margin:"normal",onChange:function(e){s(e._d),t.onChange(e._d)},value:n})})}var p=a(426);function b(t){var e=l.a.useState(null===t||void 0===t?void 0:t.value),a=Object(i.a)(e,2),n=a[0],s=a[1],c="no"===!t.fullWidth;return Object(u.jsx)(o.a,{utils:r.a,children:Object(u.jsx)(p.a,{format:"HH:mm",fullWidth:c,margin:"normal",ampm:!1,minutesStep:5,onChange:function(e){s(e._d),t.onChange(e._d)},value:n,style:t.style,className:t.className})})}var f=a(330);function j(t){var e=l.a.useState(null===t||void 0===t?void 0:t.value),a=Object(i.a)(e,2),n=a[0],s=a[1],c="no"===!t.fullWidth;return Object(u.jsx)(o.a,{utils:r.a,children:Object(u.jsx)(f.a,{format:"YYYY-MM-DD",fullWidth:c,margin:"normal",onChange:function(e){s(e._d),t.onChange(e._d)},value:n,style:t.style})})}function h(t){return Object(u.jsxs)(u.Fragment,{children:["datetime"===t.type&&Object(u.jsx)(d,Object(n.a)({},t)),"date"===t.type&&Object(u.jsx)(j,Object(n.a)({},t)),"time"===t.type&&Object(u.jsx)(b,Object(n.a)({},t))]})}},413:function(t,e,a){},415:function(t,e,a){},416:function(t,e,a){},417:function(t,e,a){},429:function(t,e,a){"use strict";a.r(e);var n=a(97),i=a(88),s=a(11),l=a(0),o=a.n(l),c=a(196),r=a(327),u=a(323),d=a(325),p=a(51),b=a(155),f=a.n(b),j=a(22),h=a(56),m=a(76),O=a(102),v=a(77),x=a(78),y=a(281),g=a(335),k=a(287),T=a(117),C=a(282),S=a(331),_=a(200),E=a(283),N=a(96),w=a(285),I=a(104),V=a.n(I),P=a(98),M=a.n(P),D=a(136),F=a.n(D),A=a(414),R=a.n(A),W=a(153),L=a.n(W),H=a(156),z=a.n(H),Y=a(356),B=(a(202),a(4)),K=a(23),U=a(8),q=a(354),J=a(395),$=a(412);var G=a(99),Q=(a(413),a(2)),X=function(t){Object(v.a)(a,t);var e=Object(x.a)(a);function a(t){var l;return Object(h.a)(this,a),(l=e.call(this,t)).setOpenConfirm=function(t){return l.setState({openConfirm:t})},l.setOpen=function(t){l.setState({open:t}),t?Object.keys(B.b.dataTable).forEach((function(t){if(B.b.dataTable[t].isEditable&&["select","multi-select"].includes(B.b.dataTable[t].type)){l.task[t]=B.a[l.realId][t];var e=B.b.dataTable[t].vocabulary?B.b.dataTable[t].vocabulary:t;B.b["".concat(e,"List")]||Object(K.c)(e,"direct").then((function(t){var a={};t.forEach((function(t){a[t.id]=t})),l.setState(Object(n.a)({},"".concat(e,"List"),a))}))}})):l.props.onClose()},l.handleDateTimeChange=function(t){return function(e){return l.setState(Object(n.a)({},t,e))}},l.getRealId=function(){return B.a.map((function(t){return t.id})).indexOf(l.props.id)},l.handleOk=function(){var t=B.a[l.getRealId()],e={};Object.keys(B.b.dataTable).forEach((function(a){var n;"specificParameters"!==a&&"undefined"!==a&&("mainTable"===a?e[a]=t[a]:(e[a]=l.state[a]?l.state[a]:(null===(n=l[a])||void 0===n?void 0:n.value)||null,["datetime","date","time"].includes(B.b.dataTable[a].type)&&(e[a]=G.a.toDateTimeStr(B.b.dataTable[a].type,l.state[a]))))}));var a=!1;Object.keys(e).forEach((function(n){var i=B.b.dataTable[n],s="int"===i.type?parseInt(e[n],10):e[n];"int"!==i.type&&s!==t[n]&&(a=!0)})),"discussion"===B.b.dataTableName&&(e.participants.split(",").includes(e.responsible)||(e.participants="{dataEdited.responsible},".concat(e.participants))),a?l.props.action(l.props.id,e):console.log("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432\u043d\u0435\u0441\u0435\u043d\u043e \u043d\u0435 \u0431\u044b\u043b\u043e"),l.setOpen(!1)},l.handleSaveAsNew=function(){var t=B.a[l.getRealId()];t.date===l.state.date&&t.time===l.state.time&&l.setState({confirmMessage:"(\u0434\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043c\u044f \u043d\u0435 \u0431\u044b\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b!)"}),l.setOpenConfirm(!0)},l.confirmSaveAsNew=function(){var t=B.a[l.getRealId()],e={};Object.keys(B.b.dataTable).forEach((function(a){var n;"specificParameters"!==a&&"undefined"!==a&&(e[a]=l.state[a]?l.state[a]:(null===(n=l[a])||void 0===n?void 0:n.value)||null,"mainTable"===a&&(e[a]=t[a]),["datetime","date","time"].includes(B.b.dataTable[a].type)&&(e[a]=G.a.toDateTimeStr(B.b.dataTable[a].type,l.state[a])))})),e.week&&(e.week=parseFloat(new G.a(e.date).getYearWeekStr())),console.log(e),l.props.actionNew(e),l.setOpen(!1)},l.handleUpload=function(t,e){U.a.alert.dispatch({type:"SHOW_ALERT",status:"warn",message:"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f..."}),Object(K.b)(t.target.files[0]).then((function(t){var a=Object(s.a)(t,2),o=a[0];if(a[1])U.a.alert.dispatch({type:"SHOW_ALERT",status:"fail",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435"});else{U.a.alert.dispatch({type:"SHOW_ALERT",status:"success",message:"\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e, \u0441\u0441\u044b\u043b\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430"});var c="http://".concat(window.location.host,"/smisplan-docs/").concat(o.fileName);l[e].value="{this[property].value}\n".concat(c);var r=[];l.state["".concat(e,"FilesAttached")]&&r.push.apply(r,Object(i.a)(l.state["".concat(e,"FilesAttached")])),r.push(c),l.setState(Object(n.a)({},"".concat(e,"FilesAttached"),r))}}))},l.openUrl=function(t){return window.open(t,"_blank","")},l.filterValidKeys=function(t){return"specificParameters"!==t&&"undefined"!==t},l.sortValidKeys=function(t,e){return B.b.dataTable[t].tableIndex>=B.b.dataTable[e].tableIndex?1:-1},l.state={openConfirm:!1,confirmMessage:"",printPDF:!1,tasksList:[]},l._dataRef=o.a.createRef(),l.setOpen=l.setOpen.bind(Object(O.a)(l)),l.props.id&&(l.realId=B.a.map((function(t){return t.id})).indexOf(l.props.id),l.task=B.a[l.realId],Object.keys(B.b.dataTable).forEach((function(t){-1!==["datetime","date"].indexOf(B.b.dataTable[t].type)?l.state[t]=l.task[t]&&""!==l.task[t]?l.task[t]:null:-1!==["time"].indexOf(B.b.dataTable[t].type)?l.state[t]=l.task[t]&&""!==l.task[t]?"2000-01-01T".concat(l.task[t]):null:-1!==["select","multi-select"].indexOf(B.b.dataTable[t].type)&&(l.state[t]=l.task[t]);var e=[];/\b(http:.+?)(txt|docx?|xlsx?|pptx?|pdf|png|bmp|img|jpg|jpeg)\b/im.test(l.task[t])&&(e.push(l.task[t].match(/\b(http:.+?)(txt|doc|docx|ppt|pptx|xls|xlsx|pdf|png|bpm|img|jpg|jpeg)\b/gi)),l.state["".concat(t,"FilesAttached")]=e[0])}))),l}return Object(m.a)(a,[{key:"render",value:function(){var t=this,e=[].concat(Object.keys(B.b.dataTable).filter(this.filterValidKeys).filter((function(t){return B.b.dataTable[t].isEditable})).sort(this.sortValidKeys),Object.keys(B.b.dataTable).filter(this.filterValidKeys).filter((function(t){return!B.b.dataTable[t].isEditable})).sort(this.sortValidKeys));return this.task&&Object(Q.jsxs)(y.a,{open:this.props.isOpened,onClose:this.props.onClose,"aria-labelledby":"dialog-title",fullWidth:!0,classes:{paper:"dialog-edit"},children:[Object(Q.jsxs)("div",{className:"popup-edit__header",children:[Object(Q.jsx)(g.a,{id:"dialog-title",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}),Object(Q.jsxs)("div",{className:"popup-edit__print-doc",children:[Object(Q.jsx)(L.a,{trigger:function(){return Object(Q.jsx)(k.a,{title:"\u041f\u0435\u0447\u0430\u0442\u0430\u0442\u044c",children:Object(Q.jsx)(T.a,{className:"icn",style:{padding:"0px"},children:Object(Q.jsx)(V.a,{fontSize:"large"})})})},content:function(){return t.setState({printPDF:!0}),t._dataRef.current},onAfterPrint:function(){t.setState({printPDF:!1})}}),"discussion"===B.b.dataTableName&&Object(Q.jsx)(j.a,{class:"icn_save",tip:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 MS Word",fontSize:"large",action:function(){return function(t){U.a.alert.dispatch({type:"SHOW_ALERT",status:"warn",message:"\u0418\u0434\u0451\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430..."});var e=new J.Document,a=[];try{t.forEach((function(t){a.push(new J.Paragraph({children:[new J.TextRun({text:t,size:"24",font:"Arial"})]}))})),e.addSection({children:a}),J.Packer.toBlob(e).then((function(t){Object($.saveAs)(t,"SMISPlan document.docx"),U.a.alert.dispatch({type:"SHOW_ALERT",status:"success",message:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d \u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d"})}))}catch(n){U.a.alert.dispatch({type:"SHOW_ALERT",status:"fail",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0438/\u0438\u043b\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438"}),console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0438/\u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430: ".concat(n))}return!0}(function(t,e){var a=["\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u0437\u0430\u0434\u0430\u0447",B.b.specificParameters.tableName,""],n=[];if(Object.keys(B.b.dataTable).filter((function(t){return"specificParameters"!==t&&"undefined"!==t&&B.b.dataTable[t].isEditable})).sort((function(t,e){return B.b.dataTable[t].tableIndex>=B.b.dataTable[e].tableIndex?1:-1})).forEach((function(t){return n.push(t)})),Object.keys(B.b.dataTable).filter((function(t){return"specificParameters"!==t&&"undefined"!==t&&!B.b.dataTable[t].isEditable})).sort((function(t,e){return B.b.dataTable[t].tableIndex>=B.b.dataTable[e].tableIndex?1:-1})).forEach((function(t){return n.push(t)})),n.forEach((function(e){var n=B.b.dataTable[e],i=B.b.dataTable[e].vocabulary?B.b["".concat(B.b.dataTable[e].vocabulary,"List")]:B.b["".concat(e,"List")],s=t[e]?t[e]:"";if("mainTable"===e&&B.b.tables["".concat(s,"_meta")].specificParameters&&(s=B.b.tables["".concat(s,"_meta")].specificParameters.tableName),-1!==["select","multi-select"].indexOf(B.b.dataTable[e].type)&&""!==s){var l=s;s="",l.split(",").forEach((function(t){var e,a;s+=""===s?(null===(e=i[t])||void 0===e?void 0:e.value)||t:",".concat((null===(a=i[t])||void 0===a?void 0:a.value)||t)}))}a.push("".concat(n.value,":   ").concat(s))})),"discussion"===B.b.dataTableName){var i=e;a.push(""),i.length>0?(a.push("\u041d\u0435\u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438:"),i.forEach((function(t){return a.push(t)}))):a.push("\u041d\u0435\u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438: \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442")}return a}(t.task,t.state.tasksList),B.b)}})]})]}),Object(Q.jsx)(C.a,{ref:this._dataRef,children:e.map((function(e){var a=B.b.dataTable[e],i=B.b.dataTable[e].vocabulary?B.b.dataTable[e].vocabulary:e,s=B.b["".concat(i,"List")]?B.b["".concat(i,"List")]:t.state["".concat(i,"List")],l=t.task[e];return"mainTable"===e&&B.b.tables["".concat(l,"_meta")].specificParameters&&(l=B.b.tables["".concat(l,"_meta")].specificParameters.tableName),Object(Q.jsxs)("div",{children:[Object(Q.jsxs)("div",{className:"popup-edit__row",children:[Object(Q.jsx)("div",{style:{width:"200px",fontSize:"14px",color:a.isEditable?"":"var(--font-color-disabled)"},children:a.value}),a.isEditable&&("multi-select"===a.type||"select"===a.type)&&s&&Object(Q.jsx)(q.a,{style:{width:"100%",minHeight:"30px",marginTop:"5px"},options:Object.keys(s).sort((function(t,e){return s[t].value>=s[e].value?1:-1})).map((function(t){return{value:t,label:s[t].value}})),bottom:!0,ref:e,inputRef:function(a){t[e]=a},refName:e,defaultValue:t.task[e]?t.task[e].split(",").map((function(t){return s[t]?{value:t,label:s[t].value}:{value:t,label:t}})):null,setValue:function(a){t.setState(Object(n.a)({},e,a))},label:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c...",isMulti:"multi-select"===a.type,isCreatable:a.isSelectCreatable}),a.isEditable&&["string","int","fulltext"].includes(a.type)&&Object(Q.jsx)(S.a,{defaultValue:t.task[e],fullWidth:!0,multiline:!0,onKeyDown:function(t){return t.stopPropagation()},inputRef:function(a){t[e]=a},inputProps:{style:{fontSize:"14px",fontFamily:"var(--font-main)",maxHeight:t.state.printPDF?"2000px":"200px",overflow:"unset !important"}},endAdornment:a.hasFileUploader&&!t.state.printPDF&&Object(Q.jsx)("div",{className:"popup-edit__upload-file",children:Object(Q.jsxs)(w.a,{position:"end",children:[Object(Q.jsx)("input",{id:"editDialog-fileUploader",type:"file",style:{display:"none"},multiple:!0,onChange:function(a){return t.handleUpload(a,e)}}),Object(Q.jsx)("label",{htmlFor:"editDialog-fileUploader",children:Object(Q.jsx)(k.a,{title:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",children:Object(Q.jsx)(T.a,{color:"default",component:"span",children:Object(Q.jsx)(z.a,{})})})})]})})}),a.isEditable&&["datetime","date","time"].includes(a.type)&&Object(Q.jsx)(Y.a,{type:a.type,value:t.state[e],onChange:t.handleDateTimeChange(e)}),!a.isEditable&&Object(Q.jsx)(_.a,{defaultValue:l,inputProps:{style:{fontSize:"14px",fontFamily:"var(--font-main)"}},inputRef:function(a){t[e]=a},fullWidth:!0,disabled:!0})]},"dialogEdit-".concat(e,"-subMain")),t.state["".concat(e,"FilesAttached")]&&t.state["".concat(e,"FilesAttached")].length>0&&Object(Q.jsx)("div",{className:"popup-edit__attached-file",children:t.state["".concat(e,"FilesAttached")].map((function(e){return Object(Q.jsx)(j.a,{class:"icn_attachment",tip:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c: ".concat(e.replace(/^.+\/(.+)$/,"$1")),type:"material-ui",fontSize:"large",action:function(){return t.openUrl(e)}},"".concat(e))}))})]},"dialogEdit-".concat(e,"-main"))}))}),Object(Q.jsxs)(E.a,{className:"popup-edit__actions",children:[Object(Q.jsx)(N.a,{variant:"outlined",onClick:this.handleOk,color:"primary",className:"MuiButton-outlinedOk",startIcon:Object(Q.jsx)(M.a,{}),children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"}),B.b.specificParameters.hasEditMenuSaveAsNew&&Object(Q.jsx)(N.a,{variant:"outlined",onClick:this.handleSaveAsNew,color:"default",className:"MuiButton-outlinedDefault",startIcon:Object(Q.jsx)(R.a,{}),children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u043d\u043e\u0432\u0443\u044e"}),Object(Q.jsx)(N.a,{variant:"outlined",onClick:this.props.onClose,color:"secondary",startIcon:Object(Q.jsx)(F.a,{}),children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(Q.jsxs)(y.a,{open:this.state.openConfirm,onClose:function(){return t.setOpenConfirm(!1)},"aria-labelledby":"dialog-title",fullWidth:!0,children:[Object(Q.jsxs)(g.a,{id:"dialog-title",children:["\u0412\u044b \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 ",this.state.confirmMessage," ?"]}),Object(Q.jsxs)(E.a,{className:"popup-edit__actions",children:[Object(Q.jsx)(N.a,{variant:"outlined",onClick:this.confirmSaveAsNew,color:"primary",className:"MuiButton-outlinedOk",startIcon:Object(Q.jsx)(M.a,{}),children:"\u0414\u0430"}),Object(Q.jsx)(N.a,{variant:"outlined",onClick:function(){return t.setOpenConfirm(!1)},color:"secondary",startIcon:Object(Q.jsx)(F.a,{}),children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})]})]})]})}}]),a}(o.a.Component);a(415);function Z(t){var e=t.id,a=t.action,n=t.actionName,i=t.actionText,s=t.isOpened,l=t.onClose;return Object(Q.jsxs)(y.a,{open:s,onClose:l,"aria-labelledby":"dialog-title",fullWidth:!0,children:[Object(Q.jsxs)(g.a,{id:"dialog-title",children:["\u0412\u044b \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442\u0435 ",n," ?"]}),Object(Q.jsxs)(C.a,{children:[i&&Object(Q.jsx)("div",{className:"popup-confirm__content",children:i}),Object(Q.jsx)("span",{className:"popup-confirm__content",children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c!"})]}),Object(Q.jsxs)(E.a,{className:"popup-confirm__actions",children:[Object(Q.jsx)(N.a,{variant:"outlined",onClick:function(){a(e),l()},color:"primary",className:"MuiButton-outlinedOk",startIcon:Object(Q.jsx)(M.a,{}),children:"\u0414\u0430"}),Object(Q.jsx)(N.a,{variant:"outlined",onClick:l,color:"secondary",startIcon:Object(Q.jsx)(F.a,{}),children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})]})}var tt=o.a.memo(Z),et=a(141),at=(a(416),function(t){Object(v.a)(a,t);var e=Object(x.a)(a);function a(t){var i;Object(h.a)(this,a),(i=e.call(this,t)).handleDateTimeChange=function(t){return function(e){return i.setState(Object(n.a)({},t,e))}},i.handleOk=function(){var t={};Object.keys(i.state.fields).forEach((function(e){t[e]=""}));var e=0,a=i.props.type,n=B.b.tables["".concat(a,"_meta")];Object.keys(t).forEach((function(a){var s;t[a]=i.state[a]?i.state[a]:(null===(s=i[a])||void 0===s?void 0:s.value)||null,["datetime","date","time"].includes(n.dataTable[a].type)&&(t[a]=G.a.toDateTimeStr(n.dataTable[a].type,i.state[a])),"week"===a||t[a]&&""!==t[a]||e++})),n.dataTable.week&&(t.week=new G.a(t.date).getYearWeekStr()),e?i.setState({emptyDataError:!0}):(i.setState({emptyDataError:!1}),i.props.action(i.props.id,i.props.type,t),i.props.onClose())},i.state={open:i.props.isOpened,emptyDataError:!1};var s=i.props.type,l={},o=B.b.tables["".concat(s,"_meta")],c=B.a.map((function(t){return t.id})).indexOf(i.props.id);return Object.keys(o.dataTable).forEach((function(t){"id"!==t&&""===o.dataTable[t].defaultValue&&(l[t]={type:o.dataTable[t].type,value:o.dataTable[t].value},o.dataTable[t].initialValue&&(l[t].initialValue=Object(et.a)(c,t,o.dataTable,"initialValue")),["select","multi-select"].includes(o.dataTable[t].type)&&(l[t].list=o.dataTable[t].vocabulary||t))})),i.state.fields=l,Object.keys(l).forEach((function(t){l[t].initialValue?i.state[t]=l[t].initialValue:["datetime","date","time"].includes(l[t].type)?i.state[t]=null:i.state[t]=void 0})),i}return Object(m.a)(a,[{key:"render",value:function(){var t=this,e=this.state.fields;return Object(Q.jsxs)(y.a,{open:this.props.isOpened,onClose:function(){t.setState({emptyDataError:!1}),t.props.onClose()},"aria-labelledby":"dialog-title",fullWidth:!0,style:{overflow:"visible"},classes:{paper:"dialog-linked-data"},children:[Object(Q.jsx)(g.a,{id:"dialog-title",children:Object(Q.jsxs)("div",{className:"popup-add-linked-info__title",children:[Object(Q.jsx)("div",{children:this.props.title?this.props.title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438"}),Object(Q.jsx)(N.a,{variant:"outlined",onClick:this.props.onClose,color:"secondary",startIcon:Object(Q.jsx)(F.a,{}),children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})}),Object(Q.jsxs)(C.a,{children:[this.state.emptyDataError&&Object(Q.jsx)("div",{className:"popup-add-linked-info__err-no-data",children:"\u0414\u0430\u043d\u043d\u044b\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b"}),Object.keys(e).filter((function(t){return"week"!==t})).sort((function(t,a){return e[t].value>=e[a].value?1:-1})).map((function(a){var i=e[a],s=B.b["".concat(i.list,"List")],l=i.initialValue;return Object(Q.jsxs)("div",{className:"popup-add-linked-info__row",children:[Object(Q.jsx)("div",{className:"popup-add-linked-info__value",children:i.value}),["select","multi-select"].includes(i.type)&&Object(Q.jsx)(q.a,{style:{width:"100%",minHeight:"30px",marginTop:"5px"},options:Object.keys(s).sort((function(t,e){return s[t].value>=s[e].value?1:-1})).map((function(t){return{value:t,label:s[t].value}})),defaultValue:l?l.split(",").map((function(t){return{value:t,label:s[t].value}})):null,ref:a,inputRef:function(e){t[a]=e},setValue:function(e){return t.setState(Object(n.a)({},a,e))},label:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c...",isMulti:"multi-select"===i.type}),["fulltext","string","id"].includes(i.type)&&Object(Q.jsx)(_.a,{fullWidth:!0,value:l,onChange:t.handleDateTimeChange(a),multiline:"fulltext"===i.type}),["datetime","date","time"].includes(i.type)&&Object(Q.jsx)(Y.a,{type:i.type,onChange:t.handleDateTimeChange(a)})]},a)}))]}),Object(Q.jsx)(E.a,{className:"popup-add-linked-info__actions",children:Object(Q.jsx)(N.a,{variant:"outlined",onClick:this.handleOk,color:"primary",className:"MuiButton-outlinedOk",startIcon:Object(Q.jsx)(M.a,{}),children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c"})})]})}}]),a}(o.a.Component));a(417);function nt(t){var e=o.a.useState(!1),a=Object(s.a)(e,2),l=a[0],b=a[1],h=o.a.useState(null),m=Object(s.a)(h,2),O=m[0],v=m[1],x=o.a.useState(null),y=Object(s.a)(x,2),g=y[0],k=y[1],T=o.a.useState([]),C=Object(s.a)(T,2),S=C[0],_=C[1],E=o.a.useState(!1),N=Object(s.a)(E,2),w=N[0],I=N[1],V=o.a.useState(!1),P=Object(s.a)(V,2),M=P[0],D=P[1],F=o.a.useState({}),A=Object(s.a)(F,2),R=A[0],W=A[1],L=o.a.useRef(null),H=function(){O.parentElement.style.display="",b(!1)},z=function(t){O.parentElement.style.display="flex",k(t.currentTarget),L.current.style.marginLeft=-1*"".concat(L.current.children[1].offsetWidth+5,"px")},Y=function(t,e){b(!1),t.action.apply(t,Object(i.a)(e))},B=function(t){return W(Object(n.a)({},t,!0))},K=function(t){W({}),I(!1),D(!1),v(null),b(!1),t&&t.stopPropagation()},U=function(){return k(null)},q=function(t,e){return function(){v(null),"tasks_edit"===t.id?D(!0):"tasks_delete"===t.id?I(!0):"discussion"===t.id||"question"===t.id?B(t.id):t.action(e)}};return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(j.a,{class:"icn_moreH",tip:"\u041c\u0435\u043d\u044e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439",action:function(e){W({}),w&&I(!1),M&&D(!1),v(e.currentTarget),b(!0),_(t.list)}}),l&&Object(Q.jsx)(c.a,{keepMounted:!0,anchorEl:O,open:!!O,onClose:function(){H(),v(null)},className:"tbl-action-menu",children:S.map((function(e,a){var n,i;return Object(Q.jsxs)("div",{children:["divider"===e.id&&Object(Q.jsx)(r.a,{},"menu-divider-".concat(a)),"divider"!==e.id&&!e.isListOfItems&&Object(Q.jsxs)(u.a,{onClick:q(e,t.id),children:[Object(Q.jsxs)(d.a,{children:["tasks_edit"===e.id&&Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(j.a,{class:"icn_".concat(e.id),tip:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(Q.jsx)(X,{isOpened:M,onClose:K,id:t.id,action:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return Y(e,a)},actionNew:e.actionNew,task:t.task})]}),["discussion","question"].includes(e.id)&&Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(j.a,{class:"icn_".concat(e.id),tip:e.value,type:"material-ui"}),Object(Q.jsx)(at,{isOpened:R[e.id]||!1,onClose:K,id:t.id,action:e.action,type:e.type})]}),"tasks_delete"===e.id&&Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(j.a,{class:"icn_".concat(e.id),tip:e.actionName}),Object(Q.jsx)(tt,{isOpened:w,onClose:K,id:t.id,action:e.action,actionText:"\u0422\u0435\u043c\u0430: ".concat(null===(n=t.task)||void 0===n?void 0:n.value)})]}),["tasks_edit","tasks_delete","discussion","question"].includes(e.id)?null:Object(Q.jsx)(j.a,{class:"icn_".concat(e.id),action:e.actionName,actionName:e.actionName,actionText:null===(i=t.task)||void 0===i?void 0:i.value,tip:e.value})]}),Object(Q.jsx)(p.a,{variant:"inherit",noWrap:!0,children:e.value})]},"menu-".concat(e.id,"-menuItem")),"divider"!==e.id&&e.isListOfItems&&Object(Q.jsxs)(u.a,{onClick:z,children:[Object(Q.jsx)(d.a,{children:Object(Q.jsx)(f.a,{fontSize:"medium"})}),Object(Q.jsx)(p.a,{variant:"inherit",noWrap:!0,children:e.value})]},"menu-".concat(e.id,"-menuItem")),"divider"!==e.id&&e.isListOfItems&&Object(Q.jsx)(c.a,{keepMounted:!0,anchorEl:g,ref:L,open:!!g,onClose:U,children:Object.keys(e.listItems).map((function(a){return Object(Q.jsx)(u.a,{onClick:function(){H(),v(null),k(null),e.action(t.id,a)},children:e.listItems[a].value},"menu".concat(e.id,"-menuItem-sub-").concat(a))}))},"menu".concat(e.id,"-menuItem-sub"))]},"".concat(a))}))})]})}e.default=o.a.memo(nt)}}]);
//# sourceMappingURL=6.45b552e1.chunk.js.map